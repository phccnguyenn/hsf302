<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/header :: header}"></head>

<body>
<!-- Reusing our navbar and footer for a consistent layout -->
<div th:replace="~{fragments/navbar :: navbar}"></div>

<main class="container">
    <!-- Main title for the page -->
    <h1 class="page-title">Browse All Movies</h1>

    <!-- ================================== -->
    <!--      FILTER & SORT BAR             -->
    <!-- ================================== -->
    <div class="filter-bar">
        <!-- Filter by Genre -->
        <div class="filter-group">
            <label for="genre-filter">Genre</label>
            <select id="genre-filter" name="genre">
                <option value="all">All Genres</option>
                <option value="action">Action</option>
                <option value="comedy">Comedy</option>
                <option value="drama">Drama</option>
                <option value="sci-fi">Sci-Fi</option>
                <option value="horror">Horror</option>
            </select>
        </div>

        <!-- Sort By -->
        <div class="filter-group">
            <label for="sort-by">Sort By</label>
            <select id="sort-by" name="sort">
                <option value="popularity">Popularity</option>
                <option value="release-date">Release Date</option>
                <option value="title-az">A-Z</option>
            </select>
        </div>
    </div>


    <!-- ================================== -->
    <!--      THE MOVIE GRID                -->
    <!-- ================================== -->
    <!-- We reuse the exact same movie-grid and movie-card classes! -->
    <!-- TABS FOR NOW SHOWING / COMING SOON -->
    <div class="movie-tabs">
        <button class="tab-btn active" data-tab="now-showing-grid">Now Showing</button>
        <button class="tab-btn" data-tab="coming-soon-grid">Coming Soon</button>
    </div>

    <!-- GRID FOR "NOW SHOWING" MOVIES -->
    <div class="tabbed-movie-content">

    <div id="now-showing-grid" class="movie-grid active">
        <div class="movie-card" th:each="movie : ${nowShowingMovies}">
            <!-- The movie card structure is identical -->
            <img th:src="${movie.movieUrl}" alt="Movie Poster">
            <div class="movie-card-content">
                <h3 th:text="${movie.title}">Movie Title</h3>
                <p>
                    <span>Action</span> |
                    <span th:text="${movie.duration} + ' min'">Duration</span>
                </p>
            </div>
            <div class="movie-card-actions">
                <a th:href="@{/movies/{id}(id=${movie.movieId})}" class="btn btn-secondary">Details</a>
                <a th:href="@{/booking/{id}/showtimes(id=${movie.movieId})}" class="btn btn-primary">Book Now</a>
            </div>
        </div>
    </div>

    <!-- GRID FOR "COMING SOON" MOVIES (initially hidden) -->
    <div id="coming-soon-grid" class="movie-grid">
        <div class="movie-card" th:each="movie : ${comingSoonMovies}">
            <!-- The movie card structure is identical -->
            <img th:src="${movie.movieUrl}" alt="Movie Poster">
            <div class="movie-card-content">
                <h3 th:text="${movie.title}">Movie Title</h3>
                <p>Action</p>
            </div>
            <div class="movie-card-actions">
                <a href="#" class="btn btn-secondary">Details</a>
            </div>
        </div>
    </div>
    </div>




    <!-- ================================== -->
    <!--      PAGINATION                    -->
    <!-- ================================== -->
    <nav class="pagination">
        <ul>
            <li><a href="#" class="disabled">&laquo;</a></li>
            <li><a href="#" class="active">1</a></li>
            <li><a href="#">2</a></li>
            <li><a href="#">3</a></li>
            <li><a href="#">&raquo;</a></li>
        </ul>
    </nav>
</main>

<div th:replace="~{fragments/footer :: footer}"></div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tabButtons = document.querySelectorAll('.tab-btn');
        const movieGrids = document.querySelectorAll('.movie-grid');

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons and grids
                tabButtons.forEach(btn => btn.classList.remove('active'));
                movieGrids.forEach(grid => grid.classList.remove('active'));

                // Add active class to the clicked button
                button.classList.add('active');

                // Add active class to the corresponding grid
                const targetGridId = button.getAttribute('data-tab');
                document.getElementById(targetGridId).classList.add('active');
            });
        });
    });
</script>
</body>
</html>