<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/header :: header}"></head>

<body>

<!-- Navigation -->
<div th:replace="~{fragments/navbar :: navbar}"></div>

<main>
    <div class="container">
        <!-- Page Title -->
        <div class="page-header">
            <h1 class="page-title">My Tickets</h1>
            <p class="page-subtitle">Manage your movie bookings and view ticket history</p>
        </div>

        <!-- Ticket Tabs -->
        <div class="ticket-tabs">
            <button class="ticket-tab-btn active" data-tab="upcoming">Upcoming Shows</button>
            <button class="ticket-tab-btn" data-tab="past">Past Shows</button>
        </div>

        <!-- Upcoming Tickets Section -->
        <div id="upcoming-tickets" class="ticket-section active">
            <div th:if="${hasUpcomingTickets}" class="tickets-grid">
                <div th:each="ticket : ${upcomingTickets}" class="ticket-card">
                    <div class="ticket-poster">
                        <img th:src="${ticket.moviePoster}" th:alt="${ticket.movieTitle}" />
                        <div class="ticket-status" th:classappend="${ticket.statusBadgeClass}">
                            <span th:text="${ticket.statusText}">Confirmed</span>
                        </div>
                    </div>
                    <div class="ticket-info">
                        <div class="ticket-header">
                            <h3 class="ticket-movie-title" th:text="${ticket.movieTitle}">Movie Title</h3>
                            <span class="ticket-id" th:text="'#' + ${ticket.id}">#TK001</span>
                        </div>
                        
                        <div class="ticket-details">
                            <div class="detail-row">
                                <i class="icon-cinema"></i>
                                <span th:text="${ticket.cinemaName}">CGV Vincom Center</span>
                            </div>
                            <div class="detail-row">
                                <i class="icon-screen"></i>
                                <span th:text="${ticket.theaterName}">Screen 1</span>
                            </div>
                            <div class="detail-row">
                                <i class="icon-calendar"></i>
                                <span th:text="${ticket.formattedShowDate}">Mon, 15 Nov 2024</span>
                            </div>
                            <div class="detail-row">
                                <i class="icon-clock"></i>
                                <span th:text="${ticket.formattedShowTime}">19:30</span>
                            </div>
                            <div class="detail-row">
                                <i class="icon-seat"></i>
                                <span>Seats: <strong th:text="${ticket.seats}">F7, F8</strong></span>
                            </div>
                            <div class="detail-row">
                                <i class="icon-format"></i>
                                <span th:text="${ticket.format}">2D</span>
                            </div>
                        </div>
                        
                        <div class="ticket-footer">
                            <div class="ticket-price">
                                <span class="price-amount" th:text="${ticket.formattedTotalAmount}">240,000 VND</span>
                            </div>
                            <div class="ticket-actions">
                                <a th:href="@{/ticket/{id}(id=${ticket.id})}" class="btn btn-outline">View Details</a>
                                <button class="btn btn-primary ticket-download-btn" th:data-ticket-id="${ticket.id}">
                                    Download
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Empty State for Upcoming Tickets -->
            <div th:unless="${hasUpcomingTickets}" class="empty-state">
                <div class="empty-icon">üé¨</div>
                <h3>No Upcoming Shows</h3>
                <p>You don't have any upcoming movie tickets.</p>
                <a th:href="@{/movies}" class="btn btn-primary">Browse Movies</a>
            </div>
        </div>

        <!-- Past Tickets Section -->
        <div id="past-tickets" class="ticket-section">
            <div th:if="${hasPastTickets}" class="tickets-grid">
                <div th:each="ticket : ${pastTickets}" class="ticket-card past-ticket">
                    <div class="ticket-poster">
                        <img th:src="${ticket.moviePoster}" th:alt="${ticket.movieTitle}" />
                        <div class="ticket-status" th:classappend="${ticket.statusBadgeClass}">
                            <span th:text="${ticket.statusText}">Used</span>
                        </div>
                    </div>
                    <div class="ticket-info">
                        <div class="ticket-header">
                            <h3 class="ticket-movie-title" th:text="${ticket.movieTitle}">Movie Title</h3>
                            <span class="ticket-id" th:text="'#' + ${ticket.id}">#TK004</span>
                        </div>
                        
                        <div class="ticket-details">
                            <div class="detail-row">
                                <i class="icon-cinema"></i>
                                <span th:text="${ticket.cinemaName}">CGV Vincom Center</span>
                            </div>
                            <div class="detail-row">
                                <i class="icon-screen"></i>
                                <span th:text="${ticket.theaterName}">Screen 2</span>
                            </div>
                            <div class="detail-row">
                                <i class="icon-calendar"></i>
                                <span th:text="${ticket.formattedShowDate}">Fri, 01 Nov 2024</span>
                            </div>
                            <div class="detail-row">
                                <i class="icon-clock"></i>
                                <span th:text="${ticket.formattedShowTime}">20:15</span>
                            </div>
                            <div class="detail-row">
                                <i class="icon-seat"></i>
                                <span>Seats: <strong th:text="${ticket.seats}">E5, E6</strong></span>
                            </div>
                            <div class="detail-row">
                                <i class="icon-format"></i>
                                <span th:text="${ticket.format}">3D</span>
                            </div>
                        </div>
                        
                        <div class="ticket-footer">
                            <div class="ticket-price">
                                <span class="price-amount" th:text="${ticket.formattedTotalAmount}">280,000 VND</span>
                            </div>
                            <div class="ticket-actions">
                                <a th:href="@{/ticket/{id}(id=${ticket.id})}" class="btn btn-outline">View Details</a>
                                <button class="btn btn-secondary" disabled>Used</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Empty State for Past Tickets -->
            <div th:unless="${hasPastTickets}" class="empty-state">
                <div class="empty-icon">üìΩÔ∏è</div>
                <h3>No Past Shows</h3>
                <p>You haven't watched any movies yet.</p>
                <a th:href="@{/movies}" class="btn btn-primary">Start Watching</a>
            </div>
        </div>
    </div>
</main>

<!-- Footer -->
<div th:replace="~{fragments/footer :: footer}"></div>

<!-- JavaScript for Tab Functionality -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Tab switching functionality
    const tabButtons = document.querySelectorAll('.ticket-tab-btn');
    const ticketSections = document.querySelectorAll('.ticket-section');
    
    tabButtons.forEach(button => {
        button.addEventListener('click', function() {
            const targetTab = this.dataset.tab;
            
            // Remove active class from all tabs and sections
            tabButtons.forEach(btn => btn.classList.remove('active'));
            ticketSections.forEach(section => section.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding section
            this.classList.add('active');
            document.getElementById(targetTab + '-tickets').classList.add('active');
        });
    });
    
    // Download ticket functionality
    const downloadButtons = document.querySelectorAll('.ticket-download-btn');
    downloadButtons.forEach(button => {
        button.addEventListener('click', function() {
            const ticketId = this.dataset.ticketId;
            // You can implement actual download functionality here
            alert('Download functionality for ticket ' + ticketId + ' will be implemented');
        });
    });
});
</script>

</body>
</html>